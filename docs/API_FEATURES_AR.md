# نظام API المطعم - قائمة المميزات الكاملة

## مرجع سريع

- **عنوان URL الأساسي**: `http://localhost:8000/api/v1/`
- **الإنتاج**: `https://web-production-e1bea.up.railway.app`
- **توثيق API**: `/api/schema/swagger-ui/`
- **الإصدار**: 2.0.0

## المصادقة

### نظام رموز JWT
- **رمز الوصول**: عمر 30 دقيقة
- **رمز التحديث**: عمر 7 أيام
- **تنسيق الرأس**: `Authorization: Bearer {token}`

### نقاط النهاية
```
POST /auth/register/    - تسجيل مستخدم جديد
POST /auth/login/       - تسجيل الدخول والحصول على الرموز
POST /auth/refresh/     - تحديث رمز الوصول
GET  /profile/          - الحصول على ملف المستخدم
```

## الميزات الأساسية

### 1. إدارة القائمة
- منتجات مصنفة حسب الفئات
- البحث والتصفية
- ترقيم الصفحات (20 عنصر/صفحة)
- حالة توفر المنتج
- دعم الصور

### 2. سلة التسوق
- سلة واحدة لكل مستخدم
- تسعير لقطة (يُحفظ عند الإضافة)
- حساب الإجماليات تلقائياً
- التحقق من المخزون
- الحد الأقصى للكمية: 99/عنصر

### 3. إدارة الطلبات
- إنشاء من السلة
- سجل الطلبات
- تتبع الحالة (معلق → قيد التحضير → في الطريق → تم التوصيل)
- دعم الكوبونات
- التكامل مع المخزون

### 4. نظام الكوبونات
- خصومات بالنسبة المئوية/مبلغ ثابت
- حدود الاستخدام
- كوبونات خاصة بالمستخدم
- متطلبات الحد الأدنى للطلب
- API للتحقق

### 5. المراجعات والتقييمات
- تقييمات من 1-5 نجوم
- عمليات الشراء المؤكدة
- إشراف المسؤول
- التصويت على الفائدة
- إحصائيات التقييم

### 6. إدارة العناوين
- عناوين متعددة لكل مستخدم
- دعم الموقع الجغرافي
- تنظيم حسب التسمية

### 7. إدارة المخزون
- تتبع المخزون في الوقت الفعلي
- تنبيهات المخزون المنخفض
- تعطيل تلقائي عند نفاد المخزون
- سجل تدقيق كامل

## الميزات التقنية

### الأداء
- نظام التخزين المؤقت (محلي/Redis)
- تحسين الاستعلامات
- فهارس قاعدة البيانات
- ترقيم فعال

### الأمان
- مصادقة JWT
- تحديد المعدل
- دعم CORS
- تشفير كلمة المرور
- التحقق من الإدخال

### الجودة
- تغطية اختبار 80%+
- بنية طبقة الخدمات
- مبادئ SOLID
- كود نظيف

### المراقبة
- سجلات دوارة
- تتبع الأخطاء
- مسجلات خاصة بالتطبيق

## نماذج قاعدة البيانات

```
User (مدمج في Django)
├── Cart (1:1)
│   └── CartItem (1:N)
├── Order (1:N)
│   ├── OrderItem (1:N)
│   └── OrderStatusHistory (1:N)
├── Address (1:N)
├── Review (1:N)
└── CouponUsage (1:N)

Category (1:N) → Product
├── ProductInventory (1:1)
    └── InventoryTransaction (1:N)

Coupon (1:N) → CouponUsage
```

## تنسيق استجابة API

### استجابة ناجحة
```json
{
  "id": 1,
  "data": {...}
}
```

### استجابة مرقمة
```json
{
  "count": 100,
  "next": "http://api/endpoint/?page=2",
  "previous": null,
  "results": [...]
}
```

### استجابة خطأ
```json
{
  "detail": "رسالة الخطأ"
}
```

## رموز الحالة

- `200 OK` - نجاح
- `201 Created` - تم إنشاء المورد
- `204 No Content` - نجاح، لا توجد بيانات
- `400 Bad Request` - إدخال غير صالح
- `401 Unauthorized` - مطلوب مصادقة
- `403 Forbidden` - رفض الإذن
- `404 Not Found` - المورد غير موجود
- `429 Too Many Requests` - تم تجاوز الحد
- `500 Internal Server Error` - خطأ في الخادم

## حدود المعدل

- **مجهول**: 100 طلب/ساعة
- **مصادق عليه**: 2000 طلب/يوم

## النشر

### متغيرات البيئة
```
DEBUG=False
SECRET_KEY=your-secret-key
DATABASE_URL=postgresql://...
ALLOWED_HOSTS=your-domain.com
CORS_ALLOWED_ORIGINS=https://your-frontend.com
```

### قائمة فحص الإنتاج
- ✅ تعيين DEBUG=False
- ✅ تكوين SECRET_KEY
- ✅ تعيين DATABASE_URL
- ✅ تشغيل الترحيلات
- ✅ جمع الملفات الثابتة
- ✅ تكوين المضيفين المسموح بهم
- ✅ إعداد ذاكرة التخزين المؤقت Redis
- ✅ تكوين التسجيل

## البدء السريع

```bash
# التثبيت
pip install -r requirements.txt

# الترحيل
python manage.py migrate

# إنشاء مستخدم متميز
python manage.py createsuperuser

# تشغيل الخادم
python manage.py runserver

# تشغيل الاختبارات
python manage.py test

# التغطية
coverage run --source='.' manage.py test
coverage report
```

## الدعم

- **Swagger UI**: `/api/schema/swagger-ui/`
- **ReDoc**: `/api/schema/redoc/`
- **لوحة المسؤول**: `/admin/`
- **السجلات**: `logs/restaurant.log`, `logs/errors.log`

---

**الإصدار 2.0.0** | **جاهز للإنتاج** ✅
